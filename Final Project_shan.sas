Title 'Final Project Crude Oil Prices';

data Crude_Prices;
input Year Month Prices;
time = _n_;
datalines;
1983	4	30.50
1983	5	30.16
1983	6	30.96
1983	7	31.59
1983	8	31.88
1983	9	31.24
1983	10	30.40
1983	11	29.86
1983	12	29.24
1984	1	29.65
1984	2	30.05
1984	3	30.72
1984	4	30.65
1984	5	30.55
1984	6	29.98
1984	7	28.74
1984	8	29.33
1984	9	29.38
1984	10	28.80
1984	11	28.11
1984	12	26.91
1985	1	25.64
1985	2	27.14
1985	3	28.12
1985	4	28.71
1985	5	27.58
1985	6	27.09
1985	7	27.27
1985	8	27.74
1985	9	28.22
1985	10	29.48
1985	11	30.73
1985	12	27.15
1986	1	22.98
1986	2	15.46
1986	3	12.62
1986	4	12.75
1986	5	15.26
1986	6	13.38
1986	7	11.58
1986	8	15.11
1986	9	14.94
1986	10	14.89
1986	11	15.23
1986	12	16.09
1987	1	18.67
1987	2	17.73
1987	3	18.28
1987	4	18.60
1987	5	19.33
1987	6	19.99
1987	7	21.33
1987	8	20.23
1987	9	19.52
1987	10	19.86
1987	11	18.85
1987	12	17.26
1988	1	17.15
1988	2	16.76
1988	3	16.21
1988	4	17.88
1988	5	17.45
1988	6	16.56
1988	7	15.51
1988	8	15.53
1988	9	14.46
1988	10	13.80
1988	11	13.98
1988	12	16.28
1989	1	17.98
1989	2	17.82
1989	3	19.44
1989	4	20.94
1989	5	20.03
1989	6	19.99
1989	7	19.66
1989	8	18.55
1989	9	19.59
1989	10	20.10
1989	11	19.83
1989	12	21.09
1990	1	22.64
1990	2	22.11
1990	3	20.41
1990	4	18.58
1990	5	18.46
1990	6	16.86
1990	7	18.64
1990	8	27.18
1990	9	33.69
1990	10	35.92
1990	11	32.30
1990	12	27.16
1991	1	24.70
1991	2	20.54
1991	3	19.88
1991	4	20.82
1991	5	21.25
1991	6	20.20
1991	7	21.43
1991	8	21.68
1991	9	21.86
1991	10	23.23
1991	11	22.43
1991	12	19.53
1992	1	18.82
1992	2	19.01
1992	3	18.95
1992	4	20.26
1992	5	21.00
1992	6	22.36
1992	7	21.74
1992	8	21.29
1992	9	21.92
1992	10	21.71
1992	11	20.36
1992	12	19.41
1993	1	19.07
1993	2	20.08
1993	3	20.35
1993	4	20.33
1993	5	19.98
1993	6	19.13
1993	7	17.90
1993	8	18.01
1993	9	17.52
1993	10	18.17
1993	11	16.74
1993	12	14.53
1994	1	15.02
1994	2	14.78
1994	3	14.65
1994	4	16.33
1994	5	17.83
1994	6	19.07
1994	7	19.66
1994	8	18.38
1994	9	17.47
1994	10	17.71
1994	11	18.10
1994	12	17.16
1995	1	17.99
1995	2	18.53
1995	3	18.55
1995	4	19.89
1995	5	19.74
1995	6	18.40
1995	7	17.26
1995	8	17.81
1995	9	18.21
1995	10	17.40
1995	11	18.00
1995	12	19.04
1996	1	18.77
1996	2	18.78
1996	3	21.18
1996	4	23.30
1996	5	21.09
1996	6	20.43
1996	7	21.25
1996	8	21.91
1996	9	23.93
1996	10	24.90
1996	11	23.55
1996	12	25.12
1997	1	25.18
1997	2	22.17
1997	3	20.97
1997	4	19.73
1997	5	20.87
1997	6	19.22
1997	7	19.66
1997	8	19.95
1997	9	19.78
1997	10	21.28
1997	11	20.22
1997	12	18.32
1998	1	16.73
1998	2	16.08
1998	3	15.04
1998	4	15.46
1998	5	14.93
1998	6	13.67
1998	7	14.09
1998	8	13.38
1998	9	14.97
1998	10	14.42
1998	11	13.04
1998	12	11.31
1999	1	12.49
1999	2	12.02
1999	3	14.68
1999	4	17.30
1999	5	17.77
1999	6	17.92
1999	7	20.10
1999	8	21.28
1999	9	23.79
1999	10	22.67
1999	11	24.77
1999	12	26.09
2000	1	27.01
2000	2	29.30
2000	3	29.89
2000	4	25.54
2000	5	28.81
2000	6	31.53
2000	7	29.72
2000	8	31.14
2000	9	33.87
2000	10	32.93
2000	11	34.26
2000	12	28.40
2001	1	29.26
2001	2	29.64
2001	3	27.27
2001	4	27.62
2001	5	28.68
2001	6	27.58
2001	7	26.47
2001	8	27.31
2001	9	25.83
2001	10	22.21
2001	11	19.67
2001	12	19.40
2002	1	19.73
2002	2	20.76
2002	3	24.44
2002	4	26.26
2002	5	26.95
2002	6	25.55
2002	7	26.94
2002	8	28.20
2002	9	29.67
2002	10	28.86
2002	11	26.19
2002	12	29.39
2003	1	32.70
2003	2	35.73
2003	3	33.16
2003	4	28.14
2003	5	28.07
2003	6	30.52
2003	7	30.70
2003	8	31.60
2003	9	28.31
2003	10	30.35
2003	11	31.06
2003	12	32.14
2004	1	34.22
2004	2	34.50
2004	3	36.72
2004	4	36.62
2004	5	40.28
2004	6	38.05
2004	7	40.81
2004	8	44.88
2004	9	45.94
2004	10	53.09
2004	11	48.48
2004	12	43.26
2005	1	46.85
2005	2	48.05
2005	3	54.63
2005	4	53.22
2005	5	49.87
2005	6	56.42
2005	7	59.03
2005	8	64.99
2005	9	65.55
2005	10	62.27
2005	11	58.34
2005	12	59.45
2006	1	65.54
2006	2	61.93
2006	3	62.97
2006	4	70.16
2006	5	70.96
2006	6	70.97
2006	7	74.46
2006	8	73.08
2006	9	63.90
2006	10	59.14
2006	11	59.40
2006	12	62.09
2007	1	54.35
2007	2	59.39
2007	3	60.74
2007	4	64.04
2007	5	63.53
2007	6	67.53
2007	7	74.15
2007	8	72.36
2007	9	79.63
2007	10	85.66
2007	11	94.63
2007	12	91.74
2008	1	92.93
2008	2	95.35
2008	3	105.42
2008	4	112.46
2008	5	125.46
2008	6	134.02
2008	7	133.48
2008	8	116.69
2008	9	103.76
2008	10	76.72
2008	11	57.44
2008	12	42.04
2009	1	41.92
2009	2	39.26
2009	3	48.06
2009	4	49.95
2009	5	59.21
2009	6	69.70
2009	7	64.29
2009	8	71.14
2009	9	69.47
2009	10	75.82
2009	11	78.15
2009	12	74.60
2010	1	78.40
2010	2	76.45
2010	3	81.29
2010	4	84.58
2010	5	74.12
2010	6	75.40
2010	7	76.38
2010	8	76.67
2010	9	75.55
2010	10	81.95
2010	11	84.31
2010	12	89.23
2011	1	89.58
2011	2	89.74
2011	3	102.98
2011	4	110.04
2011	5	101.36
2011	6	96.29
2011	7	97.34
2011	8	86.34
2011	9	85.61
2011	10	86.43
2011	11	97.16
2011	12	98.58
2012	1	100.32
2012	2	102.26
2012	3	106.21
2012	4	103.35
2012	5	94.72
2012	6	82.41
2012	7	87.93
2012	8	94.16
2012	9	94.56
2012	10	89.57
2012	11	86.73
2012	12	88.25
2013	1	94.83
2013	2	95.32
2013	3	92.96
2013	4	92.07
2013	5	94.80
2013	6	95.80
2013	7	104.70
2013	8	106.54
2013	9	106.24
2013	10	100.55
2013	11	93.93
2013	12	97.89
2014	1	94.86
2014	2	100.68
2014	3	100.51
2014	4	102.03
2014	5	101.79
2014	6	105.15
2014	7	102.39
2014	8	96.08
2014	9	93.03
2014	10	84.34
2014	11	75.81
2014	12	59.29
2015	1	47.33
2015	2	50.72
2015	3	47.85
2015	4	54.63
2015	5	59.37
2015	6	59.83
2015	7	50.93
2015	8	42.89
2015	9	45.47
2015	10	46.25
2015	11	42.92
2015	12	37.33
2016	1	31.78
2016	2	30.62
2016	3	37.96
2016	4	41.12
2016	5	46.80
2016	6	48.84
2016	7	44.80
2016	8	44.80
2016	9	45.23
2016	10	49.87
2016	11	45.87
2016	12	52.17
2017	1	52.61
2017	2	53.46
2017	3	49.67
2017	4	51.12
2017	5	48.54
2017	6	45.20
2017	7	46.68
2017	8	48.06
2017	9	49.88
2017	10	50.50
;

run;

Proc gplot data=Crude_Prices ;
	symbol1 color=blue interpol=join v=dot ;
	plot Prices*time=1 ;
run ;

/***********The model is non stationary and differencing needs to be applied ****************/

data Crude_Prices_diff;
set Crude_Prices;
lnPrices=log(Prices);
diffPrices=dif(lnPrices);
run;

Proc gplot data=Crude_Prices_diff ;
	symbol1 color=blue interpol=join v=dot ;
	plot diffPrices*time=1 ;
run ;


/********************************arima modeling to check for ACF and PACF values********************************/
/***********************We then predict our AR or MA model and check them using regression*********************/
Proc arima data=Crude_Prices_diff ;
 	identify var=diffPrices nlag=12 ;
	run;

/*****************Creating lags and residuals in the model *******************/

data Crude_Prices_model;
set Crude_Prices_diff;
p1=lag(diffPrices);
p2=lag(p1);
p3=lag(p2);
p4=lag(p3);
p5=lag(p4);
run;
/****************This will give us residuals to test for adequacy**************/
proc reg data=Crude_Prices_model;
model diffPrices=p1 p2 p3 p4 p5;
output out=Crude_Prices_out r=residual;
run;

/*******************Creates lag for residuals***************/
data Crude_Prices_out;
set Crude_Prices_out;
r1=lag(residual);
r2=lag(r1);
run;

/******************We pick best three regression models after cp criterion for estimation for minimum SSE************/
proc reg data=Crude_Prices_out;
model diffPrices = p1 p2 r1 r2/method=cp;
run;

proc arima data=Crude_Prices_model;
identify var=diffPrices ESACF;
estimate p = 1 plot;
estimate p = 2 q = 1 plot;
estimate p = 2 q = 2 plot;

run;
quit;

proc arima data=Crude_Prices_model;
identify var=lnPrices(1);
estimate p=2 q=1 plot;
run;
forecast lead=12 interval=Month id=Month out=results;
run;

proc arima data=a;
      identify var=price(1);
      estimate p=2;
      identify var=sales(1) crosscorr=price(1);
      estimate p=1 q=1 input=price;
      forecast lead=12 interval=onth id=date out=results;
   run;

proc arima data=seriesg; 
      identify var=xlog(1,12) nlag=15; 
	  run;
      estimate q=(1)(12) noconstant method=uls ; 
      run; 
      forecast out=b lead=24 id=date interval=month noprint; 
	  run;

